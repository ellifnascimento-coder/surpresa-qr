<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>carregando surpresa...</title>
  
<style>
:root{
  --bg:#0f0f14;
  --text:#fff;
  --btn:#2196f3;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:monospace;
  display:flex;
  justify-content:center;
  align-items:center;

  min-height:100vh; /* ‚Üê AQUI */
  overflow-x:hidden; /* ‚Üê AQUI */
}

.card{
  max-width:520px;
  position:relative;
  z-index:1;
  transition:opacity .25s ease; transform .12s ease; /* fade suave entre etapas */
}

button{
  margin-top:25px;
  padding:12px 26px;
  border-radius:10px;
  border:none;
  background:var(--btn);
  color:#fff;
  cursor:pointer;
}

.progress{
  height:16px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin-top:20px;
}

.bar{
  height:100%;
  width:0%;
  background:#2196f3;
}

.error{
  color:#ff5555;
  white-space:pre-line;
  text-align:left;
}

.floating{
  position:fixed;
  font-size:11px;
  opacity:.2;
  pointer-events:none;
  z-index:-1; /* atr√°s do card */
}
  
.card{
  min-height: 220px;
  padding: 20px;
}

#buttons{
  margin-top: 25px;
  min-height: 60px;
}

button{
  font-size:16px;
  min-width:120px;
}


/* =========================================
   ‚ö° GLITCH (ANTES DO V√çDEO FINAL)
   FICA DENTRO DO STYLE
========================================= */

.glitch{
  animation: glitch .15s infinite;
}

@keyframes glitch{
  0%{transform:translate(2px,-2px)}
  25%{transform:translate(-2px,2px)}
  50%{transform:translate(2px,2px)}
  75%{transform:translate(-2px,-2px)}
  100%{transform:translate(0,0)}
}

</style>


<body>
<div class="card">
  <div id="content"></div>
  <div id="buttons"></div>
</div>


<script>
const content = document.getElementById("content");
const buttons = document.getElementById("buttons");

  /* üî• ATIVA √ÅUDIO NO iOS (necess√°rio) */
document.body.addEventListener("touchstart", ()=>getCtx(), {once:true});
document.body.addEventListener("click", ()=>getCtx(), {once:true});


/* =====================================================
   üîä VIBRAR
===================================================== */

  function vibrar(ms=120){
  if(navigator.vibrate) navigator.vibrate(ms);
}


/* =====================================================
   üîä AUDIO CONTEXT + BEEP
===================================================== */
let audioCtx;
function getCtx(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  }
  return audioCtx;
}
function beep(freq=700,duration=80){
  const ctx=getCtx();
  const osc=ctx.createOscillator();
  const gain=ctx.createGain();

  osc.type="square";
  osc.frequency.value=freq;

  osc.connect(gain);
  gain.connect(ctx.destination);

  gain.gain.setValueAtTime(0.05,ctx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.00001,ctx.currentTime+duration/1000);

  osc.start();
  osc.stop(ctx.currentTime+duration/1000);
}
function errorNoise(){ beep(120,200); }

/* =====================================================
   üéµ √ÅUDIOS
===================================================== */
const audioEtapa1 = new Audio("etapa1.mp3");
const audioEtapa5 = new Audio("etapa5.mp3");
const audioFinal  = new Audio("APERTA O PLAY.mp3.mpeg");

audioEtapa5.loop = true;
audioFinal.loop  = true;

// üî• importante (melhora compatibilidade mobile)
audioEtapa1.preload = "auto";
audioEtapa5.preload = "auto";
audioFinal.preload  = "auto";

/* fun√ß√µes */
function play1(){
  audioEtapa1.currentTime = 0;
  audioEtapa1.play();
}

function stop1(){
  audioEtapa1.pause();
}

function iniciarLoopMusica(){
  audioEtapa5.currentTime = 0;
  audioEtapa5.play();
}

function pararMusica(){
  audioEtapa5.pause();
}

function tocarFinal(){
  audioFinal.currentTime = 0;
  audioFinal.volume = 1;   // üî• garante volume m√°ximo
  audioFinal.play();
}

function pararFinal(){
  audioFinal.pause();
  audioFinal.currentTime = 0; // üî• reseta (evita continuar depois)
}

/* =====================================================
   AUX
===================================================== */
function setButton(text,fn){
  buttons.innerHTML="";
  const b=document.createElement("button");
  b.innerText=text;
  b.onclick=fn;
  buttons.appendChild(b);
}

/* =====================================================
   üíô EFEITOS VISUAIS EXTRAS
===================================================== */

function batimento(){

  // vibra√ß√£o (android)
  vibrar(60);
  setTimeout(()=>vibrar(40),120);

  // som grave tipo cora√ß√£o
  beep(90,120);
  setTimeout(()=>beep(70,100),120);

  // micro "pulsar" visual
  const card = document.querySelector('.card');

  card.style.transform = "scale(1.04)";
  setTimeout(()=>{
    card.style.transform = "scale(1)";
  },120);
}

  /* =====================================================
   üíô CHUVA DE CORA√á√ïES
===================================================== */
function chuvaCoracoes(qtd=25){
  for(let i=0;i<qtd;i++){

    const h=document.createElement("div");
    h.innerText="üíô";

    h.style.position="fixed";
    h.style.left=Math.random()*100+"vw";
    h.style.bottom="-30px";
    h.style.fontSize=(18+Math.random()*26)+"px";
    h.style.opacity=.95;
    h.style.pointerEvents="none";
    h.style.zIndex="9999";
   h.style.transition="transform 3.5s ease-out, opacity 3.5s";

    document.body.appendChild(h);

    // anima subir
    setTimeout(()=>{
      h.style.transform="translateY(-120vh)";
      h.style.opacity=0;
    },50);

    // remove depois
    setTimeout(()=>h.remove(),3000);
  }
}

  
/* =====================================================
   ETAPA 0
===================================================== */
function etapa0(){
  limparTudo();
  content.innerHTML=`‚ö†Ô∏è<br><br>aumente o volume do celular<br>para a experi√™ncia perfeita`;
  setButton("ok",()=>{ play1(); etapa1(); });
}

/* =====================================================
   ETAPA 1
===================================================== */
function etapa1(){
  limparTudo();

  content.innerHTML=`
    <img src="Gatinho.png" style="
      width:180px;
      display:block;
      margin:0 auto 20px;
      border-radius:12px;
    ">
    
    voc√™ acabou de escanear um QR Code.<br><br>
    n√£o tem volta.
  `;

  setButton("seguir mesmo assim",()=>{
    stop1();
    etapa2();
  });
}

/* =====================================================
   ETAPA 2
===================================================== */
function etapa2(){
  limparTudo();
  content.innerHTML=`
coletando dados...<br><br>
<span id="s">surpresa: ...</span><br>
<span id="c">confus√£o: ...</span><br>
<span id="j">julgamento silencioso: ...</span>
`;
  setButton("prosseguir",etapa3);

  const s=document.getElementById("s");
  const c=document.getElementById("c");
  const j=document.getElementById("j");

  function revelar(el,texto,delay,freq){
    setTimeout(()=>{ el.innerText=texto; beep(freq,120); },delay);
  }

  revelar(s,"surpresa: OK",600,900);
  revelar(c,"confus√£o: OK",1400,650);
  revelar(j,"julgamento silencioso: PROV√ÅVEL",2200,450);
}

/* =====================================================
   ETAPA 3
===================================================== */
function etapa3(){
  limparTudo();
  content.innerHTML=`
carregando conte√∫do de baixa qualidade...<br><br>
<div class="progress"><div class="bar" id="bar"></div></div>
<div id="percent" style="margin-top:15px;font-size:20px;font-weight:bold">0%</div>
`;
  const bar=document.getElementById("bar");
  const percent=document.getElementById("percent");
  let width=0;
  const interval=setInterval(()=>{
    width++;
    bar.style.width=width+"%";
    percent.textContent=width+"%";
    if(width>=100){
      clearInterval(interval);
      percent.textContent="100% ‚úì";
      setButton("aceitar termos que n√£o li",etapa4);
    }
  },20);
}

/* =====================================================
   ETAPA 4
===================================================== */
function etapa4(){
  limparTudo();
  content.innerHTML=`
<div class="error">
ERROS FATAIS DETECTADOS

[FAIL] QR Code em flores
[FAIL] essa p√°gina existir
[CRITICAL] voc√™ ainda aqui

Sistema inst√°vel.
Recomendado: fechar o navegador.
</div>`;
  errorNoise();
vibrar(300);
  setButton("continuar por curiosidade",etapa5);
}

/* =====================================================
   ETAPA 5
===================================================== */
function etapa5(){
  limparTudo();

  content.innerHTML=`
    <img src="Flerte.png" style="
      width:180px;
      display:block;
      margin:0 auto 20px;
      border-radius:12px;
    ">

    isso N√ÉO √© um flerte.<br>
    talvez seja.<br>
    depende do ponto de vista.<br>
    dos astros.<br>
    e do seu humor hoje.<br>
  `;

  setTimeout(()=>iniciarLoopMusica(),100);

  setButton("ok mas quero ver",()=>{
    pararMusica();
    etapa6();
  });
}

/* =====================================================
   ETAPA 6 ‚Äì respira√ß√£o + textos espalhados
===================================================== */
let respiraInterval; // vari√°vel global para limpar o intervalo
function etapa6(){
  limparTudo();
  content.innerHTML=`PAUSA OBRIGAT√ìRIA.<br><br><span id="respira" style="font-size:22px;opacity:.8">inspira‚Ä¶</span>`;
  const r = document.getElementById("respira");

  let estado = true;
  respiraInterval = setInterval(()=>{
    r.innerText = estado ? "expira‚Ä¶" : "inspira‚Ä¶";
    r.style.opacity = estado ? ".3" : "1";
    estado = !estado;
  }, 900);

 // espalha textos flutuantes atr√°s do card, mais leg√≠vel
const numFlutuantes = 15; // menos que 30
for(let i=0;i<numFlutuantes;i++){
  const t=document.createElement("div");
  t.className="floating";
  t.innerText="*observa√ß√£o irrelevante: eu sou meio apaixonada por voc√™";
  
  t.style.left=(10 + i*5 + Math.random()*20) + "vw"; // espalha horizontal
  t.style.top=(5 + i*5 + Math.random()*10) + "vh";    // espalha vertical
  t.style.fontSize="14px";
  t.style.opacity=0.15 + Math.random()*0.2;
  t.style.transform=`rotate(${Math.random()*30-15}deg)`;
  document.body.appendChild(t);
}
  setButton("fingir que n√£o li e continuar", etapa7);
}

/* =====================================================
   ETAPA 7 ‚Äì psicologia reversa
===================================================== */
function etapa7(){
  limparTudo();
  clearInterval(respiraInterval);

  content.innerHTML=`aviso:<br>nada aqui faz sentido.<br>a curiosidade venceu.`;

  const card = document.querySelector('.card');
  const continuar=document.createElement("button");
  continuar.innerText="continuar";
  const parar=document.createElement("button");
  parar.innerText="parar";
  buttons.appendChild(continuar);
  buttons.appendChild(parar);

  // Bloqueia o bot√£o parar
  parar.onclick=()=>{ beep(200,150); alert("Voc√™ n√£o pode clicar aqui"); };

  let fugidas=0;

  // Coloca bot√£o relativo ao card
  continuar.style.position="absolute";
  continuar.style.left="50%";
  continuar.style.top="50%";
  continuar.style.transform = "translate(-50%, -50%)"; // centraliza corretamente

  // Detecta se √© touch (celular)
  const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

  // Fun√ß√£o que move o bot√£o
  function moverBotao() {
      fugidas++;
      if(fugidas <= 6){
          const cardRect = card.getBoundingClientRect();
          const btnWidth = continuar.offsetWidth;
          const btnHeight = continuar.offsetHeight;

          // Calcula nova posi√ß√£o dentro do card, com margem
          const padding = 10;
          const newLeft = Math.random() * (cardRect.width - btnWidth - padding*2) + padding;
          const newTop  = Math.random() * (cardRect.height - btnHeight - padding*2) + padding;

          continuar.style.left = newLeft + "px";
          continuar.style.top  = newTop  + "px";
      } else {
          // 6¬™ tentativa
          continuar.remove();
          parar.remove();
          mostrarBal√£oDecisao();
      }
  }

  if(isTouch){
      continuar.addEventListener("touchstart", (e)=>{
          e.preventDefault(); // evita clique normal
          moverBotao();
      }, {passive:false});
  } else {
      continuar.onmouseover = moverBotao;
  }
}

// Fun√ß√£o que mostra o bal√£o de decis√£o SIM / N√ÉO
function mostrarBal√£oDecisao(){
  content.innerHTML="J√° perdeu a paci√™ncia?<br><br>";
  
  const simBtn=document.createElement("button");
  simBtn.innerText="Sim";
  const naoBtn=document.createElement("button");
  naoBtn.innerText="N√£o";

  buttons.appendChild(simBtn);
  buttons.appendChild(naoBtn);

  simBtn.onclick=()=>{ content.innerHTML="sabia."; setButton("ok, terminar logo isso", etapa8); };
  naoBtn.onclick=()=>{ content.innerHTML="para de mentir pra si mesma"; setButton("ok, terminar logo isso", etapa8); };
  tocarFinal();   // üî• come√ßa a m√∫sica no clique
}

/* =====================================================
   ETAPA 8 
===================================================== */

function etapa8(){
  limparTudo();

  content.innerHTML="parab√©ns.<br>voc√™ chegou at√© o final.";

  setButton("ver conclus√£o", ()=>{
    pararFinal(); // üî• para a m√∫sica de fundo
    etapa9();
    
  });
}


function mostrarShrek(){

  limparTudo();
  
  content.innerHTML = `
  <div style="text-align:center">
    <p style="margin-bottom:15px">t√° bom‚Ä¶ agora √© s√©rio üòè</p>

    <video 
      controls
      preload="auto"
      playsinline
      style="width:100%; border-radius:12px;">
      <source src="shrek.mp4" type="video/mp4">
    </video>
  </div>
  `;
}

  /* =====================================================
   ETAPA 9 ‚Äì cl√≠max fofo + meme
===================================================== */
function etapa9(){
  limparTudo();

  content.innerHTML=`
  espera...<br><br>
  s√≥ mais um segundo.
  `;

  // üíì batimento card√≠aco
  [0,300,600,900].forEach(t=>setTimeout(batimento,t));

  // üíô cora√ß√µes
  setTimeout(()=>chuvaCoracoes(30),500);

  // ‚ö° glitch + v√≠deo
  setTimeout(()=>{
    document.body.classList.add("glitch");
    beep(120,120);

    setTimeout(()=>{
      document.body.classList.remove("glitch");
      mostrarShrek();
    },350);

  },1800);
}

/* =====================================================
   LIMPAR TUDO
===================================================== */
let primeiraExecucao = true;

function limparTudo(){
  const card=document.querySelector('.card');

  buttons.innerHTML="";
  document.querySelectorAll(".floating").forEach(e=>e.remove());
  clearInterval(respiraInterval);

  // üëâ PRIMEIRA TELA: SEM anima√ß√£o nenhuma
  if(primeiraExecucao){
    primeiraExecucao=false;
    card.style.opacity=1;
    return;
  }

  // üëâ outras telas: fade simples
  card.style.opacity=0;

  requestAnimationFrame(()=>{
    card.style.opacity=1;
  });
}


etapa0();
</script>
</body>
</html>
