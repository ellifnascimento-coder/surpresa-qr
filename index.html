<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>carregando surpresa...</title>

<style>
:root{
  --bg:#0f0f14;
  --text:#fff;
  --btn:#2196f3;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:monospace;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  text-align:center;
  overflow:hidden;
}

.card{max-width:520px}

button{
  margin-top:25px;
  padding:12px 26px;
  border-radius:10px;
  border:none;
  background:var(--btn);
  color:#fff;
  cursor:pointer;
}

.progress{
  height:16px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin-top:20px;
}

.bar{
  height:100%;
  width:0%;
  background:#2196f3;
}

.error{
  color:#ff5555;
  white-space:pre-line;
  text-align:left;
}

.floating{
  position:fixed;
  font-size:11px;
  opacity:.2;
  pointer-events:none;
}
</style>
</head>

<body>
<div class="card">
  <div id="content"></div>
  <div id="buttons"></div>
</div>

<script>
const content = document.getElementById("content");
const buttons = document.getElementById("buttons");

/* =====================================================
   üîä √ÅUDIOS LOCAIS
===================================================== */

const audioEtapa1 = new Audio("etapa1.mp3");
const audioEtapa5 = new Audio("etapa5.mp3");

audioEtapa5.loop = true;

function play1(){ audioEtapa1.currentTime=0; audioEtapa1.play(); }
function stop1(){ audioEtapa1.pause(); }

function play5(){ audioEtapa5.currentTime=0; audioEtapa5.play(); }
function stop5(){ audioEtapa5.pause(); }

/* =====================================================
   BEEP + ERRO
===================================================== */

function beep(freq=700, duration=80){

  const ctx = getCtx();

  const osc = ctx.createOscillator();
  const gain = ctx.createGain();

  osc.type = "square";
  osc.frequency.value = freq;

  osc.connect(gain);
  gain.connect(ctx.destination);

  // volume come√ßa alto
  gain.gain.setValueAtTime(0.05, ctx.currentTime);

  // üî• fade out (mata qualquer som preso)
  gain.gain.exponentialRampToValueAtTime(
    0.00001,
    ctx.currentTime + duration/1000
  );

  osc.start();
  osc.stop(ctx.currentTime + duration/1000);
}

/* =====================================================
   AUX
===================================================== */

function setButton(text,fn){
  buttons.innerHTML="";
  const b=document.createElement("button");
  b.innerText=text;
  b.onclick=fn;
  buttons.appendChild(b);
}

function piscar(el,text,delay,speed){
  setTimeout(()=>{
    el.innerText=text;
    setInterval(()=>{
      beep(800,40);
    },speed);
  },delay);
}

/* =====================================================
   ETAPA 0 (ALERTA VOLUME)
===================================================== */

function etapa0(){

content.innerHTML=`
‚ö†Ô∏è<br><br>
aumente o volume do celular<br>
para a experi√™ncia perfeita
`;

buttons.innerHTML="";

const ok=document.createElement("button");
ok.innerText="ok";

ok.onclick=()=>{
  play1();  // come√ßa m√∫sica etapa 1
  etapa1();
};

buttons.appendChild(ok);
}

/* =====================================================
   ETAPA 1
===================================================== */

function etapa1(){
content.innerHTML=`
voc√™ acabou de escanear um QR Code.<br><br>
n√£o tem volta.
`;

setButton("seguir mesmo assim", ()=>{
  stop1(); // PARA m√∫sica etapa 1
  etapa2();
});
}

/* =====================================================
   ETAPA 2 (BEEP + piscando)
===================================================== */

function etapa2(){

content.innerHTML=`
coletando dados...<br><br>

<span id="s">surpresa: ...</span><br>
<span id="c">confus√£o: ...</span><br>
<span id="j">julgamento silencioso: ...</span>
`;

const s=document.getElementById("s");
const c=document.getElementById("c");
const j=document.getElementById("j");

setButton("prosseguir", etapa3);


/* üî• fun√ß√£o simples (1 beep s√≥) */
function revelar(el,texto,delay,freq){

  setTimeout(()=>{

    el.innerText = texto;

    beep(freq,120); // üîä s√≥ 1 som curto

    el.style.opacity="0.3";

    setTimeout(()=>{
      el.style.opacity="1";
    },120);

  },delay);
}


/* tempos sincronizados */
revelar(s,"surpresa: OK",600,900);
revelar(c,"confus√£o: OK",1400,650);
revelar(j,"julgamento silencioso: PROV√ÅVEL",2200,450);

}

/* =============================
   ETAPA 3 ‚Äì barra real + % VIS√çVEL
============================= */
function etapa3(){

content.innerHTML=`
carregando conte√∫do de baixa qualidade...<br><br>

<div class="progress">
  <div class="bar" id="bar"></div>
</div>

<div id="percent" style="margin-top:15px;font-size:20px;font-weight:bold">
0%
</div>
`;

buttons.innerHTML="";

const bar=document.getElementById("bar");
const percent=document.getElementById("percent");

let width=0;

const interval=setInterval(()=>{

  width++;

  bar.style.width = width+"%";
  percent.textContent = width+"%";

  if(width>=100){
    clearInterval(interval);
    percent.textContent="100% ‚úì";
    setButton("aceitar termos que n√£o li", etapa4);
  }

},20);

}

/* =============================
   ETAPA 4 ‚Äì tela erro forte
============================= */
function etapa4(){

content.innerHTML=`
<div class="error">
ERROS FATAIS DETECTADOS

[FAIL] QR Code em flores
[FAIL] essa p√°gina existir
[CRITICAL] voc√™ ainda aqui

Sistema inst√°vel.
Recomendado: fechar o navegador.
</div>
`;
errorNoise(); // 
setButton("continuar por curiosidade", ()=>{
  etapa5();
});


/* =============================
   ETAPA 5
============================= */
function etapa5(){

play5(); // üîä toca ao ENTRAR (aqui √© o lugar correto)

content.innerHTML=`
isso N√ÉO √© um flerte.<br>
talvez seja.<br>
depende do ponto de vista.<br>
dos astros.<br>
e do seu humor hoje.<br>
`;

setButton("ok mas quero ver", ()=>{
  stop5(); // üîá para ao sair
  etapa6();
});
}

/* =============================
   ETAPA 6 ‚Äì respira√ß√£o + textos espalhados
============================= */
function etapa6(){

content.innerHTML=`
PAUSA OBRIGAT√ìRIA.<br><br>
<span id="respira" style="font-size:22px;opacity:.8">inspira‚Ä¶</span>
`;

const r = document.getElementById("respira");

let estado = true;

/* alterna inspira/expira */
setInterval(()=>{
  r.innerText = estado ? "expira‚Ä¶" : "inspira‚Ä¶";
  r.style.opacity = estado ? ".3" : "1";
  estado = !estado;
}, 900);


/* remove antigos */
document.querySelectorAll(".floating").forEach(e=>e.remove());

/* espalha pela TELA INTEIRA (n√£o no card) */
for(let i=0;i<30;i++){

  const t=document.createElement("div");

  t.className="floating";
  t.innerText="*observa√ß√£o irrelevante: eu sou meio apaixonada por voc√™";

  t.style.left=Math.random()*100+"vw";
  t.style.top=Math.random()*100+"vh";
  t.style.transform=`rotate(${Math.random()*30-15}deg)`;

  document.body.appendChild(t);
}

setButton("fingir que n√£o li e continuar", etapa7);
}

/* =============================
   ETAPA 7 ‚Äì psicologia reversa
============================= */
function etapa7(){

content.innerHTML=`
aviso:<br>
nada aqui faz sentido.<br>
a curiosidade venceu.
`;

buttons.innerHTML="";

const sim=document.createElement("button");
sim.innerText="continuar";

const nao=document.createElement("button");
nao.innerText="parar";

buttons.appendChild(sim);
buttons.appendChild(nao);

let fugidas=0;
/* bot√£o parar bloqueado */
parar.onclick=()=>{
  beep(200,150);
};
   
/* CONTINUAR fugindo */
sim.onmouseover = ()=>{

  if(fugidas<6){
    fugidas++;
    continuar.style.position="absolute";
    continuar.style.left=Math.random()*80+"%";
    continuar.style.top=Math.random()*80+"%";
    return;
  }

  perguntar();
};

function perguntar(){

  buttons.innerHTML="";

  const sim=document.createElement("button");
  const nao=document.createElement("button");

  sim.innerText="sim";
  nao.innerText="n√£o";

  buttons.appendChild(sim);
  buttons.appendChild(nao);

  sim.onclick=mostrarSabia;

  nao.onclick=()=>{
    content.innerHTML+="<br><small>para de mentir pra si mesma.</small>";
    setButton("ok, termina logo isso", etapa8);
  };
}
}

/* =====================================================
   FINAL
===================================================== */

function mostrarSabia(){
content.innerHTML="sabia.";
setButton("ok, termina logo isso", etapa8);
}

/* =============================
   ETAPA 8
============================= */
function etapa8(){
content.innerHTML=`
parab√©ns.<br>
voc√™ chegou at√© o final.
`;
setButton("ver conclus√£o", mostrarShrek);
}

/* =============================
   SHREK
============================= */
function mostrarShrek(){
document.body.innerHTML=`
<iframe
  width="100%"
  height="100%"
  src="https://www.youtube.com/embed/_2aN_aXrQsw?autoplay=1"
  frameborder="0"
  allow="autoplay; fullscreen"
  allowfullscreen
></iframe>
`;
}

etapa0();
</script>
</body>
</html>
