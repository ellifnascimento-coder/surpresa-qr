<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>carregando surpresa...</title>
  
<style>
:root{
  --bg:#0f0f14;
  --text:#fff;
  --btn:#2196f3;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:monospace;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  overflow-x:hidden;
}

.card{
  max-width:520px;
  position:relative;
  z-index:1;
  opacity:1;
  transition: opacity .25s ease, transform .12s ease;
  min-height:220px;
  padding:20px;
}

button{
  margin-top:25px;
  padding:12px 26px;
  border-radius:10px;
  border:none;
  background:var(--btn);
  color:#fff;
  cursor:pointer;
  font-size:16px;
  min-width:120px;
}

.progress{
  height:16px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin-top:20px;
}

.bar{
  height:100%;
  width:0%;
  background:#2196f3;
}

.error{
  color:#ff5555;
  white-space:pre-line;
  text-align:left;
}

.floating{
  position:fixed;
  font-size:11px;
  opacity:.2;
  pointer-events:none;
  z-index:-1;
}

.glitch{
  animation: glitch .15s infinite;
}

@keyframes glitch{
  0%{transform:translate(2px,-2px)}
  25%{transform:translate(-2px,2px)}
  50%{transform:translate(2px,2px)}
  75%{transform:translate(-2px,-2px)}
  100%{transform:translate(0,0)}
}
</style>

<body>
<div class="card">
  <div id="content"></div>
  <div id="buttons"></div>
</div>

<script>
const content = document.getElementById("content");
const buttons = document.getElementById("buttons");

// üîä √ÅUDIO
const audioEtapa1 = new Audio("etapa1.mp3");
const audioEtapa5 = new Audio("etapa5.mp3");
const audioFinal  = new Audio("APERTA O PLAY.mp3.mpeg");
const audioAplausos = new Audio("Aplausos.mp3");

audioEtapa5.loop = true;
audioFinal.loop  = true;

audioEtapa1.preload = "auto";
audioEtapa5.preload = "auto";
audioFinal.preload  = "auto";
audioAplausos.preload = "auto";

function play1(){ audioEtapa1.currentTime=0; audioEtapa1.play(); }
function stop1(){ audioEtapa1.pause(); }
function iniciarLoopMusica(){ audioEtapa5.currentTime=0; audioEtapa5.play(); }
function pararMusica(){ audioEtapa5.pause(); }
function tocarFinal(){ audioFinal.currentTime=0; audioFinal.play(); }
function pararFinal(){ audioFinal.pause(); audioFinal.currentTime=0; }
function tocarAplausos(){ audioAplausos.currentTime=0; audioAplausos.play(); }

// AUX
function setButton(text, fn){
  buttons.innerHTML="";
  const b=document.createElement("button");
  b.innerText=text;
  b.onclick=fn;
  buttons.appendChild(b);
}

// BATIMENTO
function batimento(){
  const card=document.querySelector('.card');
  card.style.transform="scale(1.04)";
  setTimeout(()=>card.style.transform="scale(1)",120);
}

// CHUVA CORA√á√ïES
function chuvaCoracoes(qtd=25){
  for(let i=0;i<qtd;i++){
    const h=document.createElement("div");
    h.innerText="üíô";
    h.style.position="fixed";
    h.style.left=Math.random()*100+"vw";
    h.style.bottom="-30px";
    h.style.fontSize=(18+Math.random()*26)+"px";
    h.style.opacity=.95;
    h.style.pointerEvents="none";
    h.style.zIndex="9999";
    h.style.transition="transform 3.5s ease-out, opacity 3.5s";
    document.body.appendChild(h);
    setTimeout(()=>{ h.style.transform="translateY(-120vh)"; h.style.opacity=0; },50);
    setTimeout(()=>h.remove(),3000);
  }
}

// LIMPAR TUDO
let primeiraExecucao=true;
let respiraInterval;
function limparTudo(){
  buttons.innerHTML="";
  document.querySelectorAll(".floating").forEach(e=>e.remove());
  clearInterval(respiraInterval);
  const card=document.querySelector('.card');
  if(primeiraExecucao){ primeiraExecucao=false; card.style.opacity=1; return; }
  card.style.opacity=0;
  requestAnimationFrame(()=>{ card.style.opacity=1; });
}

// =====================================================
// ETAPAS (simplificado at√© o cl√≠max e aplausos)
// =====================================================

function etapa0(){
  limparTudo();
  content.innerHTML="‚ö†Ô∏è<br><br>aumente o volume do celular<br>para a experi√™ncia perfeita";
  setButton("ok",()=>{ play1(); etapa1(); });
}

function etapa1(){
  limparTudo();
  content.innerHTML=`<img src="Gatinho.png" style="width:180px;display:block;margin:0 auto 20px;border-radius:12px;">
  voc√™ acabou de escanear um QR Code babyy.<br><br>e n√£o tem volta.`;
  setButton("seguir mesmo assim",()=>{ stop1(); etapa2(); });
}

function etapa2(){ limparTudo(); content.innerHTML="coletando dados..."; setButton("prosseguir", etapa3); }
function etapa3(){ limparTudo(); content.innerHTML="carregando..."; setButton("continuar", etapa4); }
function etapa4(){ limparTudo(); content.innerHTML="ERROS FATAIS DETECTADOS"; setButton("continuar", etapa5); }

function etapa5(){
  limparTudo();
  content.innerHTML=`<img src="Flerte.png" style="width:180px;display:block;margin:0 auto 20px;border-radius:12px;">
  isso N√ÉO √© um flerte.<br>talvez seja.<br>depende do ponto de vista.`;
  setTimeout(()=>iniciarLoopMusica(),100);
  setButton("ok mas quero ver",()=>{ pararMusica(); etapa6(); });
}

function etapa6(){
  limparTudo();
  content.innerHTML="PAUSA OBRIGAT√ìRIA.<br><br><span id='respira'>inspira‚Ä¶</span>";
  const r=document.getElementById("respira");
  let estado=true;
  respiraInterval=setInterval(()=>{ r.innerText=estado?"expira‚Ä¶":"inspira‚Ä¶"; estado=!estado; },900);
  setButton("continuar", etapa7);
}

function etapa7(){
  limparTudo();
  clearInterval(respiraInterval);
  content.innerHTML="aviso:<br>nada aqui faz sentido.";
  setButton("continuar", etapa8);
}

function etapa8(){
  limparTudo();
  tocarFinal();
  content.innerHTML="parab√©ns.<br>voc√™ chegou at√© o final.";
  setButton("ver conclus√£o", ()=>{ pararFinal(); etapa9(); });
}

function mostrarShrek(){
  limparTudo();
  content.innerHTML=`<div style="text-align:center">
  <p>t√° bom‚Ä¶ agora √© s√©rio, assiste o v√≠deo üíô</p>
  <video id="videoFinal" controls style="width:100%;border-radius:12px;">
    <source src="shrek.mp4" type="video/mp4">
  </video>
  </div>`;
  const video=document.getElementById("videoFinal");
  video.onended = etapaPedido;
}

function etapa9(){
  limparTudo();
  content.innerHTML="espera... s√≥ mais um segundo.";
  [0,300,600,900].forEach(t=>setTimeout(batimento,t));
  setTimeout(()=>chuvaCoracoes(30),500);
  setTimeout(()=>{ document.body.classList.add("glitch"); setTimeout(()=>{ document.body.classList.remove("glitch"); mostrarShrek(); },350); },1800);
}

function etapaPedido(){
  limparTudo();
  content.innerHTML=`<div style="text-align:center;font-size:18px;line-height:1.7">
  Por obs√©quio, distinta dama...<br><br>
  conceder-me-ias a honra<br>
  de tua ador√°vel presen√ßa<br>
  em minha humilde morada,<br>
  para que partilhemos<br>
  uma refei√ß√£o deveras saborosa<br>
  e agrad√°vel companhia?<br><br>üíô</div>`;
  setButton("Sim", etapaCelebracao);
}

function etapaCelebracao(){
  limparTudo();
  tocarAplausos();
  content.innerHTML=`<div style="text-align:center;font-size:30px">üéâ ELA DISSE SIM üéâ<br><br>üíôüíôüíô</div>`;
  chuvaCoracoes(40);
  fogos(40);
}

function fogos(qtd=30){
  for(let i=0;i<qtd;i++){
    const f=document.createElement("div");
    f.innerText="üéÜ";
    f.style.position="fixed";
    f.style.left=Math.random()*100+"vw";
    f.style.top=Math.random()*70+"vh";
    f.style.fontSize=(22+Math.random()*30)+"px";
    f.style.opacity=0;
    f.style.pointerEvents="none";
    f.style.transition="all 1.2s ease-out";
    document.body.appendChild(f);
    setTimeout(()=>{ f.style.opacity=1; f.style.transform="scale(1.6)"; },50);
    setTimeout(()=>f.remove(),1200);
  }
}

// INICIA
etapa0();
</script>
</body>
</html>
